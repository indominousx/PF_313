Question 1
import pandas as pd
import numpy as np
import matplotlib.pyplot as plt
import seaborn as sns
df=sns.load_dataset("titanic")
print(df)

print(df.sample(10))
print(len(df[df["sex"]=="male"]))

print(df.shape[0])

df1=df[(df["sex"]=="male") & (df["alive"]=="yes")]
print(len(df1))

print(df.describe())
print(df.dtypes)

Question 2

df2=pd.read_csv("Telecom Churn.csv")
print(df2.head())
print(df2.columns)

print(df2.mean(numeric_only=True))
print(df2.count(numeric_only=True))
print(df2.std(numeric_only=True))
num_only=df2.select_dtypes(include="number")
print(num_only.quantile(0.25,numeric_only=True))
print(num_only.quantile(0.50,numeric_only=True))
print(num_only.quantile(0.75,numeric_only=True))


Question 3
import pandas as pd 
import numpy as np 
import matplotlib.pyplot as plt
import seaborn as sns

df=pd.read_csv("House Data.csv")
print(df.sample(10))

print(df.info())

df["NetSquareMeters"]=pd.to_numeric(df["NetSquareMeters"].str.replace(r"[^0-9]","",regex=True),errors="coerce")
df["NetSquareMeters"]=df["NetSquareMeters"]/10
df["NetSquareMeters"].astype(int)

print(df.info())

print(df.describe())

num_cols = df.describe().columns
print(num_cols)
for x in num_cols:
    plt.figure(figsize=(10,5))
    sns.histplot(df[x],bins=50,kde=True)
    plt.xlabel(f"Histogram of {x} ")
    plt.ylabel("Frequency")
    plt.show()



Question 4 
import pandas as pd
import numpy as np
import matplotlib.pyplot as plt
import seaborn as sns
import math

df=pd.read_csv("Lipstick.csv")
print(df.head())

def entropy(cmain):
    ent=0.0
    counts=cmain.value_counts()
    total=counts.sum()
    for c in counts:
        p=c/total
        if p>0:
            ent-=p*math.log(p,2)
    return ent

entropygain=entropy(df["Buys"])

X=["Age","Income","Gender","Ms"]
prev_ent=1.0
for c in X:
    wei_ent=0.0
    groups=df.groupby(df[c])
    for name,grp in groups:
        e=entropy(grp["Buys"])
        w=len(grp)/len(df)
        wei_ent+=w*e
    print(wei_ent,f"{c}")

    if wei_ent<prev_ent:
        prev_ent=wei_ent

info_gain= entropygain-prev_ent
print(info_gain)





Question 5
import pandas as pd
import numpy as np
import matplotlib.pyplot as plt
from sklearn.preprocessing import LabelEncoder
from sklearn.tree import DecisionTreeClassifier
from sklearn.model_selection import train_test_split

df=pd.read_csv("Lipstick.csv")
print(df.head())
print(df.columns)

le_age=LabelEncoder()
le_income=LabelEncoder()
le_gender=LabelEncoder()
le_ms=LabelEncoder()
le_buys=LabelEncoder()

df["Age"]=le_age.fit_transform(df["Age"])
df["Income"]=le_income.fit_transform(df["Income"])
df["Gender"]=le_gender.fit_transform(df["Gender"])
df["Ms"]=le_ms.fit_transform(df["Ms"])
df["Buys"]=le_buys.fit_transform(df["Buys"])


X=df[["Age","Income","Gender","Ms"]]
Y=df["Buys"]

model=DecisionTreeClassifier(criterion="entropy")
X_train,X_test,y_train,y_test=train_test_split(X,Y)
model.fit(X_train,y_train)

X_test=pd.DataFrame([{
    "Age":">35",
    "Income":"Medium",
    "Gender":"Female",
    "Ms":"Married"
}])

X_test["Age"]=le_age.fit_transform(X_test["Age"])
X_test["Income"]=le_income.fit_transform(X_test["Income"])
X_test["Gender"]=le_gender.fit_transform(X_test["Gender"])
X_test["Ms"]=le_ms.fit_transform(X_test["Ms"])

Question 5
prediction=model.predict(X_test)[0]
pred_label=le_buys.inverse_transform([prediction])[0]
print(pred_label)

Question_6_7_8 ke hisab se test dataset change karo.






